turbomem

This is the development of a reverse-engineered Linux driver for the Intel(R)
Turbo Memory PCIe NAND flash controller. The goal is to expose the flash memory
as a block device.

The driver does not yet do much for a normal user. A block device shows up,
but reading/writing is not working correctly.

After detecting a compatible device, basic info is logged to dmesg:
turbomem 0000:04:00.0: Found Intel Turbo Memory Controller (rev 11)
turbomem 0000:04:00.0: Device characteristics: 13404, flash size: 2048 MB

Notes:
------
* The supplied Vista driver requires certain SATA controller chips to install
  and work. Since this driver does no disk filtering hopefully the Turbo Memory
  will work in any board with a mini-PCIe connector.

* This driver is developed using the 2GB version of the board. 1GB and 4GB
  versions are expected to work, but may not.

Enjoy,
    Erik Ekman <erik@kryo.se>

================================================================================

Debugfs interface:

* /turbomem/turbomemX/orom (read)
  Dump the embedded disk-filtering Option ROM
  Example:

# hexdump -C /sys/kernel/debug/turbomem/turbomema/orom
00000000  55 aa 18 e9 2a 29 3f 3f  3f 3f 3f 3f 3f 3f 3f 3f  |U...*)??????????|
00000010  3f 3f 3f 3f 3f 3f 3f b9  70 00 20 00 00 00 00 00  |???????.p. .....|
00000020  24 50 6e 50 01 02 00 00  00 d6 00 00 00 00 40 00  |$PnP..........@.|
00000030  4c 00 05 80 00 e4 00 00  00 00 00 00 00 00 00 00  |L...............|
00000040  49 6e 74 65 6c 20 43 6f  72 70 2e 00 49 6e 74 65  |Intel Corp..Inte|
00000050  6c 28 52 29 20 54 75 72  62 6f 20 4d 65 6d 6f 72  |l(R) Turbo Memor|
00000060  79 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |y...............|
00000070  50 43 49 52 86 80 4e 44  00 00 18 00 00 05 80 00  |PCIR..ND........|
00000080  18 00 ea 03 00 80 00 00  00 00 00 00 00 00 00 00  |................|
00000090  46 49 4c 54 2e 12 01 01  01 00 0a 00 01 00 ea 03  |FILT............|
.... and so on.


* /turbomem/turbomemX/wipe_flash (write)
  Write anything here to erase the flash memory. Watch out.
  Example:

# echo 1 > /sys/kernel/debug/turbomem/turbomema/wipe_flash
turbomem 0000:04:00.0: Wiping flash!!
turbomem 0000:04:00.0: Wiped 16316 blocks.

